From b82b35025ab52fbccfad5201fabe86cc4030ed6b Mon Sep 17 00:00:00 2001
From: Rujun Wang <chinawrj@gmail.com>
Date: Thu, 23 Jun 2016 11:06:06 +0800
Subject: [PATCH 2/4] Fix the length of msg buffer after realloc

Signed-off-by: Rujun Wang <chinawrj@gmail.com>
(cherry picked from commit 2f09fd7181dcfdad7f5ea2937c61783122710172)
---
 libubus-io.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/libubus-io.c b/libubus-io.c
index e6d4236..e284442 100644
--- a/libubus-io.c
+++ b/libubus-io.c
@@ -259,6 +259,7 @@ static bool alloc_msg_buf(struct ubus_context *ctx, int len)
 		return false;
 
 	ctx->msgbuf.data = ptr;
+	ctx->msgbuf_data_len = len;
 	return true;
 }
 
-- 
2.17.1

